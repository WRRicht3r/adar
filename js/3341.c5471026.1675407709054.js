(self["webpackChunkpolkaswap_exchange_web"]=self["webpackChunkpolkaswap_exchange_web"]||[]).push([[3341],{32836:function(e,t,s){"use strict";s.d(t,{Z:function(){return g}});var o=s(60760),r=s(70655),a=s(53545),i=s(57950),l=s(74614),n=s(36930),u=s(37365);const c=new n.FPNumber(5256e3);let d=class extends((0,a.Wr)(u.tA.FormattedAmountMixin)){getEmission(e,t){const s=!!e?.isFarm,o=new n.FPNumber((s?t?.farmsTotalMultiplier:t?.stakingTotalMultiplier)??0);if(o.isZero())return n.FPNumber.ZERO;const r=new n.FPNumber(e?.multiplier??0),a=r.div(o),i=(s?t?.farmsAllocation:t?.stakingAllocation)??n.FPNumber.ZERO,l=t?.tokenPerBlock??n.FPNumber.ZERO;return i.mul(l).mul(a)}getApr(e,t,s){return t.isZero()?n.FPNumber.ZERO:e.mul(c).mul(s).div(t).mul(n.FPNumber.HUNDRED)}getTvl(e,t,s){return e?e.isFarm?s?n.FPNumber.fromCodecValue(s.secondBalance).div(n.FPNumber.fromCodecValue(s.balance)).mul(e.totalTokensInPool).mul(t).mul(new n.FPNumber(2)):n.FPNumber.ZERO:e.totalTokensInPool.mul(t):n.FPNumber.ZERO}};d=(0,r.__decorate)([a.wA],d);var p=d,m=s(85530);const h=(e,t=!0)=>e.reduce(((e,s)=>(s.isFarm!==t||(e[s.baseAsset]||(e[s.baseAsset]={}),e[s.baseAsset][s.poolAsset]||(e[s.baseAsset][s.poolAsset]=[]),e[s.baseAsset][s.poolAsset].push(s)),e)),{});let b=class extends((0,a.Wr)(p)){constructor(...e){super(...e),(0,o.Z)(this,"isFarmingPage",void 0),(0,o.Z)(this,"demeterPools",void 0),(0,o.Z)(this,"demeterAccountPools",void 0),(0,o.Z)(this,"tokenInfos",void 0),(0,o.Z)(this,"getAsset",void 0),(0,o.Z)(this,"showCalculatorDialog",!1),(0,o.Z)(this,"baseAsset",null),(0,o.Z)(this,"poolAsset",null),(0,o.Z)(this,"rewardAsset",null),(0,o.Z)(this,"liquidity",null)}get uniqueAssets(){const e=this.demeterPools.reduce(((e,t)=>(e.push(t.baseAsset,t.poolAsset,t.rewardAsset),e)),[]);return[...new Set(e)]}get demeterAssetsData(){return this.uniqueAssets.reduce(((e,t)=>{const s=this.getAsset(t),o=s?i.FPNumber.fromCodecValue(this.getAssetFiatPrice(s)??0):i.FPNumber.ZERO;return e[t]={...s,price:o},e}),{})}get pools(){return h(this.demeterPools,this.isFarmingPage)}get accountPools(){return h(this.demeterAccountPools,this.isFarmingPage)}get selectedPool(){return this.baseAsset&&this.poolAsset&&this.pools[this.baseAsset][this.poolAsset]?this.pools[this.baseAsset][this.poolAsset].find((e=>e.rewardAsset===this.rewardAsset)):null}get selectedAccountPool(){return this.selectedPool?this.getAccountPool(this.selectedPool):null}getDerivedPools(e){return Array.isArray(e)?e.reduce(((e,t)=>{const s=!t.isRemoved,o=this.getAccountPool(t),r=!!o&&this.isActiveAccountPool(o);return s||r?(e.push({pool:t,accountPool:o}),e):e}),[]):[]}isActiveAccountPool(e){return!(e.pooledTokens.isZero()&&e.rewards.isZero())}prepareDerivedPoolData(e,t,s){const o=this.demeterAssetsData[e.baseAsset],r=this.demeterAssetsData[e.poolAsset],a=this.demeterAssetsData[e.rewardAsset],i=this.tokenInfos[e.rewardAsset],l=this.getEmission(e,i),n=this.getTvl(e,r.price,s),u=this.getApr(l,n,a.price),c=(0,m.Gc)(u,!0),d=`$${(0,m.Gc)(n)}`;return{pool:e,accountPool:t,tokenInfo:i,baseAsset:o,poolAsset:r,rewardAsset:a,emission:l,tvl:d,apr:c}}getAccountPool(e){return this.accountPools[e.baseAsset]?.[e.poolAsset]?.find((t=>t.rewardAsset===e.rewardAsset))}showPoolCalculator(e){this.setDialogParams(e),this.showCalculatorDialog=!0}setDialogParams(e){this.baseAsset=e.baseAsset,this.poolAsset=e.poolAsset,this.rewardAsset=e.rewardAsset,this.liquidity=e.liquidity}};(0,r.__decorate)([(0,a.fI)({default:!0,type:Boolean})],b.prototype,"isFarmingPage",void 0),(0,r.__decorate)([l.SB.demeterFarming.pools],b.prototype,"demeterPools",void 0),(0,r.__decorate)([l.SB.demeterFarming.accountPools],b.prototype,"demeterAccountPools",void 0),(0,r.__decorate)([l.Yn.demeterFarming.tokenInfos],b.prototype,"tokenInfos",void 0),(0,r.__decorate)([l.Yn.assets.assetDataByAddress],b.prototype,"getAsset",void 0),b=(0,r.__decorate)([a.wA],b);var g=b},44973:function(e,t,s){"use strict";s.d(t,{w:function(){return o}});const o=e=>()=>s(12488)(`./${e}.vue`)},53341:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingState,expression:"loadingState"}],ref:"table",staticClass:"explore-table",attrs:{data:e.tableItems,"highlight-current-row":!1,size:"small"}},[s("s-table-column",{attrs:{width:"240",label:"#","fixed-position":"left"},scopedSlots:e._u([{key:"header",fn:function(){return[s("div",{staticClass:"explore-table-item-index"},[s("span",{class:["explore-table-item-index--head",{active:e.isDefaultSort}],on:{click:e.handleResetSort}},[e._v(" # ")])]),s("div",{staticClass:"explore-table-item-logo"},[s("s-icon",{staticClass:"explore-table-item-logo--head",attrs:{name:"various-bone-24",size:"14px"}})],1),s("div",{staticClass:"explore-table-item-info explore-table-item-info--head"},[s("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.t("nameText")))])])]},proxy:!0},{key:"default",fn:function(t){var o=t.$index,r=t.row;return[s("span",{staticClass:"explore-table-item-index explore-table-item-index--body"},[e._v(e._s(o+e.startIndex+1))]),1===r.assets.length?s("token-logo",{key:"token",staticClass:"explore-table-item-logo",attrs:{token:r.assets[0]}}):s("pair-token-logo",{key:"pair",staticClass:"explore-table-item-logo",attrs:{"first-token":r.assets[0],"second-token":r.assets[1],size:"small"}}),s("div",{staticClass:"explore-table-item-info explore-table-item-info--body"},[s("div",{staticClass:"explore-table-item-name"},[e._v(e._s(r.name))]),r.description?s("div",{key:"description",staticClass:"explore-table__secondary"},[e._v(e._s(r.description))]):e._e()])]}}])}),s("s-table-column",{attrs:{width:"120","header-align":"left",align:"left"},scopedSlots:e._u([{key:"header",fn:function(){return[s("sort-button",{attrs:{name:"rewardAssetSymbol",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[s("span",{staticClass:"explore-table__primary"},[e._v("Reward")])])]},proxy:!0},{key:"default",fn:function(t){var o=t.row;return[s("div",{staticClass:"explore-table-cell"},[s("token-logo",{staticClass:"explore-table-item-logo explore-table-item-logo--plain",attrs:{size:"small","token-symbol":o.rewardAsset.symbol}}),s("div",{staticClass:"explore-table-item-name"},[e._v(e._s(o.rewardAsset.symbol))])],1)]}}])}),s("s-table-column",{attrs:{width:"140","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[s("sort-button",{attrs:{name:"apr",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[s("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.TranslationConsts.APR))])])]},proxy:!0},{key:"default",fn:function(t){var o=t.row;return[s("span",{staticClass:"explore-table__accent"},[e._v(e._s(o.aprFormatted))]),s("calculator-button",{nativeOn:{click:function(t){return e.showPoolCalculator({baseAsset:o.baseAsset.address,poolAsset:o.poolAsset.address,rewardAsset:o.rewardAsset.address,liquidity:o.liquidity})}}})]}}])}),s("s-table-column",{attrs:{width:"80","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[s("sort-button",{attrs:{name:"depositFee",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[s("span",{staticClass:"explore-table__primary"},[e._v("Fee")])])]},proxy:!0},{key:"default",fn:function(t){var s=t.row;return[e._v(" "+e._s(s.depositFeeFormatted)+" ")]}}])}),e.isLoggedIn?s("s-table-column",{key:"logged",attrs:{width:"140","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[s("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.t("balanceText")))])]},proxy:!0},{key:"default",fn:function(t){var o=t.row;return[s("div",{staticClass:"explore-table-item-tokens"},e._l(o.accountTokens,(function(t,o){var r=t.asset,a=t.balance,i=t.balancePrefix;return s("div",{key:o,staticClass:"explore-table-cell"},[s("formatted-amount",{staticClass:"explore-table-item-price explore-table-item-amount",attrs:{"value-can-be-hidden":"","font-size-rate":e.FontSizeRate.SMALL,value:a},scopedSlots:e._u([{key:"prefix",fn:function(){return[e._v(e._s(i))]},proxy:!0}],null,!0)}),s("token-logo",{staticClass:"explore-table-item-logo explore-table-item-logo--plain",attrs:{size:"small",token:r}})],1)})),0)]}}],null,!1,596145239)}):e._e(),s("s-table-column",{attrs:{width:"104","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[s("sort-button",{attrs:{name:"tvl",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[s("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.TranslationConsts.TVL))]),s("s-tooltip",{attrs:{"border-radius":"mini",content:e.t("tooltips.tvl")}},[s("s-icon",{attrs:{name:"info-16",size:"14px"}})],1)],1)]},proxy:!0},{key:"default",fn:function(t){var o=t.row;return[s("formatted-amount",{staticClass:"explore-table-item-price explore-table-item-amount",attrs:{"is-fiat-value":"","font-weight-rate":e.FontWeightRate.MEDIUM,value:o.tvlFormatted.amount}},[e._v(" "+e._s(o.tvlFormatted.suffix)+" ")])]}}])})],1),s("s-pagination",{staticClass:"explore-table-pagination",attrs:{layout:"prev, total, next","current-page":e.currentPage,"page-size":e.pageAmount,total:e.filteredItems.length},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"prev-click":e.handlePrevClick,"next-click":e.handleNextClick}}),s("calculator-dialog",e._b({attrs:{visible:e.showCalculatorDialog,liquidity:e.liquidity},on:{"update:visible":function(t){e.showCalculatorDialog=t}}},"calculator-dialog",e.selectedDerivedPool,!1))],1)},r=[],a=s(60760),i=s(70655),l=s(53545),n=s(36930),u=s(37365),c=s(63637),d=s(73331),p=s(32806),m=s(32836),h=s(44973),b=s(52859),g=s(80710),v=s(16546),A=s(85530);const f=(e,t)=>[e,t].join(";");let P=class extends((0,l.Wr)(p.Z,m.Z,d.Z)){constructor(...e){super(...e),(0,a.Z)(this,"order",c.Sr.DESC),(0,a.Z)(this,"property","apr"),(0,a.Z)(this,"poolsData",{})}async updatePoolsData(){await this.withLoading((async()=>{await this.withParentLoading((async()=>{const e={},t=this.isFarmingPage,s=this.list.map((e=>f(e.baseAsset,e.poolAsset))),o=[...new Set(s)];await Promise.allSettled(o.map((async s=>{if(!e[s]){const o=await this.getPoolData(s,t);o&&(e[s]=o)}}))),this.poolsData=e}))}))}get list(){return Object.values(this.pools).map((e=>Object.values(e))).flat(2).filter((e=>!e.isRemoved))}get selectedDerivedPool(){return this.selectedPool?this.prepareDerivedPoolData(this.selectedPool,this.selectedAccountPool,this.liquidity):null}get items(){return this.list.map((e=>{const t=this.demeterAssetsData[e.baseAsset],s=this.demeterAssetsData[e.poolAsset],o=this.demeterAssetsData[e.rewardAsset],r=o?.symbol??"",a=n.FPNumber.fromCodecValue(this.getAssetFiatPrice({address:e.rewardAsset})??0),i=this.tokenInfos[e.rewardAsset],l=this.getAccountPool(e),u=!!l&&this.isActiveAccountPool(l),c=this.poolsData[f(e.baseAsset,e.poolAsset)],d=c?.price??n.FPNumber.ZERO,p=c?.reserves?.[0]??n.FPNumber.ZERO,m=c?.reserves?.[1]??n.FPNumber.ZERO,h=c?.supply??n.FPNumber.ZERO,b=l?.pooledTokens??n.FPNumber.ZERO,g=e.isFarm?{address:c?.address??"",balance:h.toCodecString(),firstAddress:t.address??"",firstBalance:p.toCodecString(),secondAddress:s?.address??"",secondBalance:m.toCodecString(),poolShare:"1",reserveA:"1",reserveB:"1",totalSupply:"1"}:null,v=e.isFarm?[t,s]:[s],P=v.map((e=>e?.symbol??"")).join("-"),y=e.isFarm?"":s?.name??"",_=new n.FPNumber(e.depositFee??0).mul(n.FPNumber.HUNDRED),w=d.mul(e.totalTokensInPool),k=this.getEmission(e,i),x=this.getApr(k,w,a),F=(e.isFarm?[{asset:t,balance:h.isZero()?n.FPNumber.ZERO:p.mul(b).div(h)},{asset:s,balance:h.isZero()?n.FPNumber.ZERO:m.mul(b).div(h)}]:[{asset:s,balance:b}]).map((e=>({...e,balance:(0,A.Gc)(e.balance),balancePrefix:e.balance.isZero()?"":"~"})));return{assets:v,name:P,description:y,baseAsset:t,poolAsset:s,rewardAsset:o,rewardAssetSymbol:r,depositFee:_.toNumber(),depositFeeFormatted:(0,A.Gc)(_,!0),tvl:w.toNumber(),tvlFormatted:(0,A.kF)(w),apr:x.toNumber(),aprFormatted:(0,A.Gc)(x,!0),isAccountItem:u,accountTokens:F,liquidity:g}}))}get preparedItems(){return this.isAccountItems?this.items.filter((e=>e.isAccountItem)):this.items}async getPoolData(e,t){const[s,o]=e.split(";"),r=n.FPNumber.fromCodecValue(this.getAssetFiatPrice({address:o})??0);if(t){const e=u.hi.poolXyk.getInfo(s,o);if(!e)return null;const t=e.address,a=await u.hi.api.query.poolXYK.totalIssuances(e.address),i=a.isEmpty?n.FPNumber.ZERO:new n.FPNumber(a),l=(await u.hi.poolXyk.getReserves(s,o)).map((e=>n.FPNumber.fromCodecValue(e))),c=l[1],d=i.isZero()?n.FPNumber.ZERO:c.mul(r).mul(new n.FPNumber(2)).div(i);return{price:d,supply:i,reserves:l,address:t}}return{price:r}}};(0,i.__decorate)([(0,l.RL)("pools",{deep:!0})],P.prototype,"updatePoolsData",null),P=(0,i.__decorate)([(0,l.wA)({components:{CalculatorButton:(0,h.w)(b.J.CalculatorButton),CalculatorDialog:(0,h.w)(b.J.CalculatorDialog),PairTokenLogo:(0,g.kF)(v.z8.PairTokenLogo),SortButton:(0,g.kF)(v.z8.SortButton),TokenLogo:u.wx.TokenLogo,FormattedAmount:u.wx.FormattedAmount}})],P);var y=P,_=y,w=s(1001),k=(0,w.Z)(_,o,r,!1,null,null,null),x=k.exports},12488:function(e,t,s){var o={"./CalculatorButton.vue":[22841,2841],"./CalculatorDialog.vue":[31927,3064,1927],"./ClaimDialog.vue":[42993,3064,2993],"./PoolCard.vue":[78449,3064,8449],"./StakeDialog.vue":[5664,3064,5664],"./StatusBadge.vue":[65059,3064,5059]};function r(e){if(!s.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return Promise.all(t.slice(1).map(s.e)).then((function(){return s(r)}))}r.keys=function(){return Object.keys(o)},r.id=12488,e.exports=r},89706:function(e,t,s){var o={"./DataContainer.vue":[53941,3064,3941],"./Pool.vue":[81226,3064,1226],"./Staking.vue":[54438,3064,4438]};function r(e){if(!s.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return Promise.all(t.slice(1).map(s.e)).then((function(){return s(r)}))}r.keys=function(){return Object.keys(o)},r.id=89706,e.exports=r}}]);