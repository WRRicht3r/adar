"use strict";(self["webpackChunkpolkaswap_exchange_web"]=self["webpackChunkpolkaswap_exchange_web"]||[]).push([[261],{80261:function(e,t,s){s.r(t),s.d(t,{default:function(){return v}});var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("router-view",e._g(e._b({},"router-view",Object.assign({},{parentLoading:e.loading},e.$attrs),!1),e.$listeners))},r=[],i=s(60760),o=s(70655),n=s(53545),c=s(37365),u=s(10909),h=s(63471),d=s(28335),l=s(74614),b=s(25108);let w=class extends((0,n.Wr)(c.tA.LoadingMixin,u.Z)){constructor(...e){super(...e),(0,i.Z)(this,"getEvmNetworkFee",void 0),(0,i.Z)(this,"updateEvmBlockNumber",void 0),(0,i.Z)(this,"updateRegisteredAssets",void 0),(0,i.Z)(this,"unwatchEthereum",void 0),(0,i.Z)(this,"blockHeadersSubscriber",void 0)}async created(){await this.withLoading((async()=>{await this.withParentLoading((async()=>{this.setEvmNetwork(d.Zc.externalNetwork),await this.onEvmNetworkTypeChange(),this.unwatchEthereum=await h.ZP.watchEthereum({onAccountChange:e=>{e.length?(this.switchExternalAccount(e[0]),this.updateExternalBalances()):this.disconnectExternalAccount()},onNetworkChange:e=>{this.onEvmNetworkTypeChange(e)},onDisconnect:()=>{this.disconnectExternalAccount()}}),this.subscribeToEvmBlockHeaders()}))}))}beforeDestroy(){"function"===typeof this.unwatchEthereum&&this.unwatchEthereum(),this.unsubscribeEvmBlockHeaders()}updateExternalBalances(e){this.updateRegisteredAssets(e)}async onEvmNetworkTypeChange(e){await Promise.all([this.setEvmNetworkType(e),this.updateExternalBalances(!0),this.getEvmNetworkFee()])}async subscribeToEvmBlockHeaders(){try{await this.unsubscribeEvmBlockHeaders();const e=await h.ZP.getEthersInstance();await this.updateEvmBlockNumber(),this.blockHeadersSubscriber=e.on("block",(e=>{this.updateEvmBlockNumber(e),this.updateExternalBalances(),this.getEvmNetworkFee()}))}catch(e){b.error(e)}}unsubscribeEvmBlockHeaders(){return new Promise(((e,t)=>{if(!this.blockHeadersSubscriber)return e();try{this.blockHeadersSubscriber.off("block"),e()}catch(s){t(s)}}))}};(0,o.__decorate)([l.aD.bridge.getEvmNetworkFee],w.prototype,"getEvmNetworkFee",void 0),(0,o.__decorate)([l.aD.bridge.updateEvmBlockNumber],w.prototype,"updateEvmBlockNumber",void 0),(0,o.__decorate)([l.aD.assets.updateRegisteredAssets],w.prototype,"updateRegisteredAssets",void 0),w=(0,o.__decorate)([n.wA],w);var k=w,p=k,E=s(1001),m=(0,E.Z)(p,a,r,!1,null,null,null),v=m.exports}}]);